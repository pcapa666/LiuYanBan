"use strict";const e=require("../../common/vendor.js"),n={data:()=>({avatarUrl:"",age:["保密","80后","90后","00后","10后","20后","永远18"],sex:["保密","男","女","沃尔玛购物袋"],userInfo:{introduction:"",ageIndex:0,sexIndex:0,nickName:"微信用户",avatarUrl:"https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0"}}),methods:{onSexChange(e){this.userInfo.sexIndex=e.detail.value},onAgeChange(e){this.userInfo.ageIndex=e.detail.value},onChooseAvatar(e){this.userInfo.avatarUrl=e.detail.avatarUrl},bindblur(e){console.log(e.detail.value),this.userInfo.nickName=e.detail.value},bindinput(e){console.log(e),this.userInfo.nickName=e.detail.value},async ok(){return(await e.Ds.uploadFile({filePath:this.userInfo.avatarUrl,cloudPath:"TouXiang.jpg"}).catch((n=>{e.index.hideLoading(),e.index.showToast({title:"头像修改失败",icon:"error"})}))).fileID},async onEdit(){e.index.showLoading({title:"上传中..."});const n=e.index.getStorageSync("token");if(this.userInfo.avatarUrl!=this.avatarUrl){let e=await this.ok();this.userInfo.avatarUrl=e}e.Ds.callFunction({name:"fun",data:{api:"changeUserInfo",token:n,userInfo:this.userInfo}}).then((n=>{e.index.hideLoading(),e.index.showToast({title:"修改资料成功",icon:"success"}),setTimeout((()=>{e.index.switchTab({url:"../my/my"})}),1e3)})).catch((()=>{e.index.hideLoading(),e.index.showToast({title:"修改资料失败",icon:"error"})}))}},onLoad(e){const n=JSON.parse(e.userInfo);this.userInfo=n,this.avatarUrl=n.avatarUrl}};const a=e._export_sfc(n,[["render",function(n,a,o,t,i,r){return{a:i.userInfo.avatarUrl,b:e.o(((...e)=>r.onChooseAvatar&&r.onChooseAvatar(...e))),c:e.o(((...e)=>r.bindblur&&r.bindblur(...e))),d:e.o([e=>i.userInfo.nickName=e.detail.value,(...e)=>r.bindinput&&r.bindinput(...e)]),e:i.userInfo.nickName,f:e.t(i.sex[i.userInfo.sexIndex]),g:i.sex,h:e.o(((...e)=>r.onSexChange&&r.onSexChange(...e))),i:e.t(i.age[i.userInfo.ageIndex]),j:i.age,k:e.o(((...e)=>r.onAgeChange&&r.onAgeChange(...e))),l:i.userInfo.introduction,m:e.o((e=>i.userInfo.introduction=e.detail.value)),n:e.o(((...e)=>r.onEdit&&r.onEdit(...e)))}}]]);wx.createPage(a);
